<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚ú® Isekai Nusantara ¬∑ Aggre To Isekai ‚ú®</title>
<!-- Font Awesome 6 (Free) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<!-- Particles.js -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<!-- Anime.js untuk animasi tambahan -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Segoe UI', 'Poppins', system-ui, sans-serif;
}

body {
min-height: 100vh;
background: radial-gradient(ellipse at top, #2a1b0e, #1a0f0a);
color: #f3e9ff;
display: flex;
justify-content: center;
align-items: center;
padding: 1rem;
position: relative;
overflow-x: hidden;
transition: background 1.5s ease;
}

body.isekai-mode {
background: radial-gradient(ellipse at top, #2a0a2a, #0a0a2a);
}

body.isekai-mode .card {
box-shadow: 0 30px 60px rgba(150, 0, 255, 0.5), 0 0 0 2px #c86bff inset, 0 0 80px #8a2be2;
}

/* Motif batik parang sederhana di background */
body::before {
content: '';
position: absolute;
top: 0; left: 0; width: 100%; height: 100%;
background-image:
repeating-linear-gradient(45deg,
rgba(210, 50, 50, 0.08) 0px, rgba(210, 50, 50, 0.08) 20px,
rgba(240, 200, 100, 0.05) 20px, rgba(240, 200, 100, 0.05) 40px),
repeating-linear-gradient(135deg,
rgba(255, 215, 0, 0.03) 0px, rgba(255, 215, 0, 0.03) 25px,
transparent 25px, transparent 50px);
pointer-events: none;
z-index: 0;
}

/* elemen wayang di pojok */
body::after {
content: '‚òØ';
position: absolute;
bottom: 20px; right: 20px;
font-size: 80px;
color: rgba(255, 200, 100, 0.1);
font-family: 'Arial';
transform: rotate(10deg);
pointer-events: none;
z-index: 0;
}

/* Particle container */
#particles-js {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
z-index: 1;
pointer-events: none;
}

/* Floating elements untuk efek fantasy */
.floating-element {
position: fixed;
width: 100px;
height: 100px;
background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%);
border-radius: 50%;
pointer-events: none;
z-index: 1;
filter: blur(5px);
animation: float 20s infinite alternate;
}

@keyframes float {
0% { transform: translate(0, 0) scale(1); opacity: 0.3; }
100% { transform: translate(100px, -100px) scale(1.5); opacity: 0.6; }
}

/* Portal overlay effect */
.portal-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: radial-gradient(circle at center, transparent 0%, #000 100%);
pointer-events: none;
z-index: 9997;
opacity: 0;
transition: opacity 0.8s ease;
}

.portal-overlay.active {
opacity: 0.9;
}

/* Portal spiral yang lebih halus */
.portal-spiral {
position: fixed;
top: 50%;
left: 50%;
transform: translate(-50%, -50%) scale(0);
width: 500px;
height: 500px;
border-radius: 50%;
background: conic-gradient(from 0deg, #ff3366, #ffcc00, #33ccff, #aa44ff, #ff3366);
box-shadow: 0 0 150px #aa44ff, 0 0 300px #ff3366;
z-index: 9998;
pointer-events: none;
opacity: 0;
transition: opacity 0.5s ease;
animation: spiralSpin 3s linear infinite;
filter: blur(2px);
}

.portal-spiral.active {
opacity: 0.8;
transform: translate(-50%, -50%) scale(2);
}

@keyframes spiralSpin {
0% { transform: translate(-50%, -50%) scale(2) rotate(0deg); filter: blur(2px); }
50% { transform: translate(-50%, -50%) scale(2.2) rotate(180deg); filter: blur(3px); }
100% { transform: translate(-50%, -50%) scale(2) rotate(360deg); filter: blur(2px); }
}

/* Portal partikel kecil (spiral dots) */
.portal-dots {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
pointer-events: none;
z-index: 9996;
}

.portal-dot {
position: absolute;
width: 4px;
height: 4px;
background: radial-gradient(circle, #fff, #ffaa33);
border-radius: 50%;
box-shadow: 0 0 10px currentColor;
animation: dotSpiral 2s linear infinite;
opacity: 0;
}

@keyframes dotSpiral {
0% { transform: rotate(0deg) translateY(-150px) rotate(0deg); opacity: 1; }
100% { transform: rotate(360deg) translateY(-150px) rotate(-360deg); opacity: 0; }
}

.card {
max-width: 1000px;
width: 100%;
background: rgba(40, 20, 10, 0.85);
backdrop-filter: blur(15px);
border: 3px solid;
border-image: linear-gradient(145deg, #d42e2e, #f7c35c) 1;
border-radius: 48px;
padding: 2.5rem 2rem;
box-shadow: 0 30px 50px rgba(0,0,0,0.7), 0 0 0 2px #b55a3a inset, 0 0 30px #ffaa33;
transition: all 0.5s ease;
z-index: 2;
position: relative;
animation: cardGlow 3s infinite alternate;
}

@keyframes cardGlow {
from { box-shadow: 0 30px 50px rgba(0,0,0,0.7), 0 0 0 2px #b55a3a inset, 0 0 30px #ffaa33; }
to { box-shadow: 0 30px 60px rgba(255,170,51,0.3), 0 0 0 2px #ffaa33 inset, 0 0 50px #ffaa33; }
}

/* sudut batik */
.card::before {
content: '';
position: absolute;
top: -10px; left: -10px; width: 100px; height: 100px;
background: radial-gradient(circle, #e05a2e40 0%, transparent 70%);
border-radius: 50%;
filter: blur(10px);
}

h1 {
font-size: 2.8rem;
font-weight: 800;
text-align: center;
background: linear-gradient(145deg, #ff3a3a, #ffffff, #ffcc00);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
margin-bottom: 0.2rem;
filter: drop-shadow(0 10px 6px #00000050);
text-shadow: 2px 2px 0 #aa2b2b;
animation: titleGlitch 3s infinite;
}

@keyframes titleGlitch {
0%, 100% { transform: skew(0deg, 0deg); opacity: 1; }
95% { transform: skew(2deg, 1deg); opacity: 0.9; text-shadow: 2px 2px 0 #ff0000; }
97% { transform: skew(-2deg, -1deg); opacity: 0.9; text-shadow: -2px -2px 0 #00ff00; }
}

.sub {
text-align: center;
margin-bottom: 2rem;
font-style: italic;
color: #ffddbb;
border-bottom: 1px dashed #cc9f6b;
padding-bottom: 0.8rem;
}
.sub i {
color: #ff4d4d;
}

/* Audio controls - ditambahkan kembali */
.audio-control {
display: flex;
justify-content: flex-end;
margin-bottom: 1rem;
gap: 1rem;
flex-wrap: wrap;
}

.music-btn {
background: linear-gradient(145deg, #4a2e6e, #2c1a40);
border: 2px solid #b48bff;
border-radius: 50px;
padding: 0.8rem 1.5rem;
color: white;
font-size: 1rem;
cursor: pointer;
display: inline-flex;
align-items: center;
gap: 0.5rem;
transition: all 0.3s ease;
box-shadow: 0 0 20px rgba(180, 139, 255, 0.3);
}

.music-btn:hover {
transform: scale(1.05);
box-shadow: 0 0 30px #b48bff;
background: linear-gradient(145deg, #5e3f90, #3b245c);
}

.music-btn.playing {
background: linear-gradient(145deg, #2e6e4a, #1a402c);
border-color: #8bffb4;
}

.audio-select {
background: #2a1a0a;
color: white;
border: 2px solid #ffaa33;
border-radius: 30px;
padding: 0.5rem 1rem;
cursor: pointer;
font-size: 0.9rem;
min-width: 200px;
}

.audio-select option {
background: #2a1a0a;
color: white;
}

.custom-url-input {
display: none;
margin-top: 10px;
padding: 8px 15px;
border-radius: 30px;
border: 2px solid #ffaa33;
background: #2a1a0a;
color: white;
width: 100%;
font-size: 0.9rem;
}

.custom-url-input:focus {
outline: none;
box-shadow: 0 0 15px #ffaa33;
}

.btn-group {
display: flex;
gap: 1rem;
justify-content: center;
flex-wrap: wrap;
margin: 1.5rem 0 2rem;
}

/* TOMBOL FINGERPRINT ISEKAI */
.isekai-btn {
border: none;
border-radius: 100px;
padding: 1.5rem 3rem;
font-size: 2rem;
font-weight: 900;
color: #fff8e7;
text-shadow: 0 0 20px #ffaa33, 0 0 40px #ff44aa;
cursor: pointer;
box-shadow: 0 20px 40px -5px #000, 0 0 50px #ff44aa, 0 0 0 4px #ffaa33 inset;
transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
border: 3px solid transparent;
background: linear-gradient(145deg, #3a1a0a, #1a0a1a);
display: inline-flex;
flex-direction: column;
align-items: center;
gap: 0.8rem;
position: relative;
overflow: visible;
z-index: 10;
animation: fingerprintPulse 2.5s infinite alternate;
transform-origin: center;
letter-spacing: 2px;
min-width: 280px;
}

.isekai-btn .fingerprint-icon {
position: relative;
width: 80px;
height: 80px;
display: flex;
justify-content: center;
align-items: center;
}

.isekai-btn .fingerprint-icon i {
font-size: 4rem;
background: linear-gradient(135deg, #fff, #ffaa33);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
filter: drop-shadow(0 0 20px #ff44aa);
animation: fingerprintGlow 2s infinite alternate;
display: inline-block;
}

.isekai-btn .ripple-circle {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
width: 100px;
height: 100px;
border-radius: 50%;
border: 2px solid rgba(255, 170, 51, 0.5);
animation: ripple 2s infinite;
}

.isekai-btn .ripple-circle:nth-child(2) {
width: 120px;
height: 120px;
animation: ripple 2s infinite 0.5s;
}

.isekai-btn .ripple-circle:nth-child(3) {
width: 140px;
height: 140px;
animation: ripple 2s infinite 1s;
}

@keyframes ripple {
0% { opacity: 1; transform: translate(-50%, -50%) scale(0.5); border-width: 2px; }
100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); border-width: 1px; }
}

@keyframes fingerprintGlow {
0% { filter: drop-shadow(0 0 10px #ff44aa); text-shadow: 0 0 20px #ffaa33; }
100% { filter: drop-shadow(0 0 30px #ff88ff); text-shadow: 0 0 40px #ff44aa; }
}

@keyframes fingerprintPulse {
0% { box-shadow: 0 20px 40px -5px #000, 0 0 50px #ff44aa, 0 0 0 4px #ffaa33 inset; transform: scale(1); }
100% { box-shadow: 0 30px 60px -5px #ff88ff, 0 0 80px #ffaa33, 0 0 0 6px #ffaa33 inset; transform: scale(1.02); }
}

.isekai-btn.scanning {
animation: scanningVibrate 0.2s infinite;
}

@keyframes scanningVibrate {
0% { transform: translate(0, 0); }
25% { transform: translate(-2px, 1px); }
50% { transform: translate(2px, -1px); }
75% { transform: translate(-1px, -2px); }
100% { transform: translate(1px, 2px); }
}

.isekai-btn.verified {
background: linear-gradient(145deg, #2a5a2a, #1a3a1a);
box-shadow: 0 0 100px #44ff44, 0 0 0 8px #aaffaa inset;
}

.isekai-btn.verified .fingerprint-icon i {
background: linear-gradient(135deg, #aaffaa, #44ff44);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
}

.detail-btn {
border: none;
border-radius: 60px;
padding: 1rem 2rem;
font-size: 1.5rem;
font-weight: 700;
color: #fff2d4;
text-shadow: 0 2px 5px #b34b00;
cursor: pointer;
box-shadow: 0 20px 30px -10px #000, 0 0 20px #f09b4a;
transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
border: 2px solid #ffb86b;
background: linear-gradient(145deg, #2f4b6e, #1a2c40);
display: inline-flex;
align-items: center;
gap: 0.5rem;
position: relative;
overflow: hidden;
}

.detail-btn::before {
content: '';
position: absolute;
top: 50%;
left: 50%;
width: 0;
height: 0;
border-radius: 50%;
background: rgba(255, 255, 255, 0.3);
transform: translate(-50%, -50%);
transition: width 0.6s, height 0.6s;
}

.detail-btn:active::before {
width: 300px;
height: 300px;
}

.isekai-btn:hover {
transform: scale(1.05);
box-shadow: 0 30px 60px -5px #ff88ff, 0 0 100px #ffaa33, 0 0 0 8px #ffaa33 inset;
}

.detail-btn:hover {
transform: scale(1.05) rotate(-1deg);
box-shadow: 0 20px 40px -5px #2a7fff, 0 0 40px #a3c6ff;
background: linear-gradient(145deg, #3f6290, #243b5c);
}

.back-btn {
background: linear-gradient(145deg, #7a4a2e, #4f301d);
border: 2px solid #e5b073;
color: white;
padding: 0.8rem 2rem;
border-radius: 40px;
font-size: 1.2rem;
font-weight: 600;
cursor: pointer;
margin-bottom: 2rem;
display: inline-block;
transition: all 0.3s ease;
}

.back-btn:hover {
background: linear-gradient(145deg, #9e623d, #6f4328);
box-shadow: 0 0 20px #ffb25e;
transform: scale(1.02) translateX(-5px);
}

.page {
display: block;
}

.hidden {
display: none;
}

.character-container {
display: flex;
flex-wrap: wrap;
gap: 2rem;
background: #2b1b0eb3;
border-radius: 40px;
padding: 2rem;
border: 2px solid #c8823a;
margin-top: 1rem;
position: relative;
box-shadow: 0 10px 20px #00000060, inset 0 0 30px #b3682a40;
animation: containerPulse 4s infinite alternate;
transform-origin: center;
transition: all 0.5s ease;
}

.character-container.isekai-enter {
animation: isekaiSpiralEnter 1.2s cubic-bezier(0.2, 0.9, 0.3, 1.1);
}

@keyframes isekaiSpiralEnter {
0% { opacity: 0; transform: scale(0.2) rotate(-180deg); filter: blur(20px) hue-rotate(90deg); }
30% { opacity: 0.7; transform: scale(1.1) rotate(10deg); filter: blur(5px) hue-rotate(0deg); }
70% { opacity: 0.9; transform: scale(0.98) rotate(-2deg); filter: blur(0); }
100% { opacity: 1; transform: scale(1) rotate(0); filter: blur(0); }
}

@keyframes containerPulse {
0% { box-shadow: 0 10px 20px #00000060, inset 0 0 30px #b3682a40; }
100% { box-shadow: 0 10px 30px #ffaa33, inset 0 0 50px #ffaa33; }
}

/* efek tier tertinggi dengan warna emas/merah */
.character-container.highest-tier-SSRplus {
box-shadow: 0 0 30px #ffb347, 0 0 60px #d43f00, inset 0 0 30px #ffaa33;
animation: tierGlow 2s infinite alternate;
}

.character-container.highest-tier-SSR {
box-shadow: 0 0 30px #ff6acb, 0 0 60px #b200ff, inset 0 0 30px #ff6acb;
animation: tierGlow 2s infinite alternate;
}

.character-container.highest-tier-S {
box-shadow: 0 0 30px #ffdb6f, 0 0 60px #ffaa33, inset 0 0 30px #ffdb6f;
}

@keyframes tierGlow {
0% { filter: brightness(1); }
100% { filter: brightness(1.2); }
}

.avatar-section {
flex: 0 0 200px;
display: flex;
flex-direction: column;
align-items: center;
gap: 0.5rem;
position: relative;
}

.avatar-img {
width: 200px;
height: 280px;
background: #4a2c1a;
border-radius: 30px;
border: 4px solid #ed9f4b;
box-shadow: 0 10px 20px #00000080;
overflow: hidden;
display: flex;
justify-content: center;
align-items: center;
transition: all 0.3s ease;
position: relative;
animation: avatarFloat 6s infinite alternate;
}

@keyframes avatarFloat {
0% { transform: translateY(0) rotate(0deg); }
100% { transform: translateY(-10px) rotate(1deg); }
}

.avatar-img img {
width: 100%;
height: 100%;
object-fit: cover;
background: #614127;
transition: all 0.3s ease;
}

.avatar-img:hover img {
transform: scale(1.05);
}

.char-name {
font-size: 1.8rem;
font-weight: 700;
background: linear-gradient(145deg, #ffb347, #ff7ee7);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
text-align: center;
animation: nameGlow 2s infinite alternate;
}

@keyframes nameGlow {
from { text-shadow: 0 0 5px #ffb347; }
to { text-shadow: 0 0 20px #ff7ee7; }
}

.gender-badge {
display: inline-block;
background: #5a351e;
border-radius: 20px;
padding: 0.2rem 1rem;
margin-left: 1rem;
font-size: 0.9rem;
border: 1px solid #e5943a;
color: #ffdcb1;
}

.avatar-badges {
display: flex;
flex-wrap: wrap;
gap: 5px;
justify-content: center;
margin-top: 5px;
}
.role-badge, .job-badge {
font-size: 0.75rem;
padding: 4px 10px;
border-radius: 20px;
background: #6b3f1f;
border: 1px solid #ffae6d;
color: #fff0d4;
font-weight: 600;
}

.stats {
flex: 1;
min-width: 300px;
}

.stat-line {
display: flex;
align-items: baseline;
padding: 0.7rem 0;
border-bottom: 1px solid #b2763b;
font-size: 1.2rem;
transition: all 0.3s ease;
}

.stat-line:hover {
transform: translateX(10px);
border-bottom-color: #ffaa33;
}

.stat-label {
width: 130px;
font-weight: 600;
color: #f7b56b;
}

.stat-value {
font-weight: 700;
color: #fff2d4;
text-transform: uppercase;
}

/* Stats Grid Styles with Level Indicator */
.stats-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
gap: 0.8rem;
margin: 1.5rem 0;
padding: 1rem;
background: #2f1e0fb3;
border-radius: 30px;
border: 1px solid #b87a3a;
}

.stat-item {
background: #3f2b19;
padding: 0.8rem;
border-radius: 20px;
display: flex;
flex-direction: column;
gap: 6px;
border-left: 4px solid #e59b4a;
transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.stat-item:hover {
transform: translateY(-5px) scale(1.02);
border-left-color: #ffaa33;
box-shadow: 0 10px 20px rgba(255, 170, 51, 0.3);
background: #4f3b29;
}

.stat-header {
display: flex;
align-items: center;
justify-content: space-between;
color: #f7b56b;
font-weight: 600;
}

.stat-name {
display: flex;
align-items: center;
gap: 5px;
}

.stat-name i {
width: 20px;
text-align: center;
}

.stat-value-number {
font-weight: 700;
color: #fff2d4;
background: #26190e;
padding: 0.2rem 0.6rem;
border-radius: 30px;
border: 1px solid #b87a3a;
font-size: 0.85rem;
}

/* Level indicator bar */
.stat-level-bar {
width: 100%;
height: 6px;
background: #26190e;
border-radius: 10px;
overflow: hidden;
margin-top: 2px;
}

.stat-level-fill {
height: 100%;
background: linear-gradient(90deg, #ffb86b, #ff6b4a);
border-radius: 10px;
transition: width 0.3s ease;
box-shadow: 0 0 10px #ffaa33;
}

.stat-item.infinity-stat .stat-level-fill {
background: linear-gradient(90deg, #ffd966, #f2b807, #ffaa33);
animation: infinityPulse 2s infinite;
width: 100% !important;
}

@keyframes infinityPulse {
0% { opacity: 0.8; }
50% { opacity: 1; box-shadow: 0 0 20px gold; }
100% { opacity: 0.8; }
}

.infinity-badge-small {
background: linear-gradient(145deg, #ffd966, #f2b807);
color: #1f0f3a;
font-weight: 900;
padding: 0.2rem 0.6rem;
border-radius: 30px;
font-size: 0.75rem;
box-shadow: 0 0 10px gold;
border: 1px solid #ffd700;
animation: shine 1.5s infinite alternate;
}

@keyframes shine {
from { filter: brightness(1); transform: scale(1); }
to { filter: brightness(1.5); transform: scale(1.1); }
}

.tier-badge {
display: inline-block;
padding: 0.3rem 0.9rem;
border-radius: 30px;
font-size: 0.9rem;
font-weight: 800;
margin-right: 0.5rem;
margin-bottom: 0.3rem;
background: #2a1a0e;
border: 1px solid currentColor;
box-shadow: 0 0 10px currentColor;
transition: all 0.3s ease;
}

.tier-badge:hover {
transform: rotate(5deg) scale(1.1);
}

.tier-E { color: #a0a0b0; border-color: #6f6f8f; }
.tier-D { color: #6fc76f; border-color: #3f9f3f; }
.tier-C { color: #6fb5ff; border-color: #2f7acf; }
.tier-B { color: #c77fff; border-color: #9f4fcf; }
.tier-A { color: #ffaa6f; border-color: #cf7f2f; }
.tier-S { color: #ffdb6f; border-color: #cfaf2f; }
.tier-SSR { color: #ff8ac9; border-color: #cf3f8f; text-shadow: 0 0 5px #ff9acb; }
.tier-SSRplus { color: #ffbe6f; border-color: #ff9f2f; background: linear-gradient(145deg, #553f1f, #2a1f0f); font-weight: 900; }

.items-grid {
display: flex;
flex-wrap: wrap;
gap: 0.5rem 1rem;
margin-top: 0.8rem;
}

.item-chip {
background: #3f2c19;
border-radius: 30px;
padding: 0.4rem 1.2rem;
font-size: 0.9rem;
border: 1px solid #b7772e;
color: #f0dbb4;
display: inline-flex;
align-items: center;
gap: 10px;
transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
position: relative;
overflow: hidden;
}

.item-chip::before {
content: '';
position: absolute;
top: -2px;
left: -2px;
right: -2px;
bottom: -2px;
background: linear-gradient(45deg, #ffaa33, #ff6b6b, #8a2be2);
border-radius: 32px;
z-index: -1;
opacity: 0;
transition: opacity 0.3s ease;
}

.item-chip:hover::before {
opacity: 0.5;
}

.item-chip:hover {
transform: rotate(2deg) scale(1.1) translateY(-5px);
border-color: transparent;
box-shadow: 0 15px 30px rgba(255, 170, 51, 0.5);
}

.item-chip i {
font-size: 1.3rem;
filter: drop-shadow(0 0 5px currentColor);
transition: all 0.3s ease;
}

.item-chip:hover i {
transform: scale(1.2) rotate(5deg);
filter: drop-shadow(0 0 15px currentColor);
}

.item-chip[data-type*="Sword"] i { color: #ff6b6b; text-shadow: 0 0 10px #ff0000; }
.item-chip[data-type*="Axe"] i { color: #ff8c42; text-shadow: 0 0 10px #ff5500; }
.item-chip[data-type*="Bow"] i { color: #6b8cff; text-shadow: 0 0 10px #0044ff; }
.item-chip[data-type*="Shield"] i { color: #4aa3ff; text-shadow: 0 0 10px #00aaff; }
.item-chip[data-type*="Helmet"] i { color: #b4b4b4; text-shadow: 0 0 10px #ffffff; }
.item-chip[data-type*="Chestplate"] i { color: #b87333; text-shadow: 0 0 10px #ff8800; }
.item-chip[data-type*="Boots"] i { color: #8b6b4a; text-shadow: 0 0 10px #aa5500; }
.item-chip[data-type*="Ring"] i { color: #ffd966; text-shadow: 0 0 10px #ffaa00; }
.item-chip[data-type*="Amulet"] i { color: #c06bff; text-shadow: 0 0 10px #aa00ff; }
.item-chip[data-type*="Staff"] i { color: #8b5a2b; text-shadow: 0 0 10px #aa4400; }
.item-chip[data-type*="Wand"] i { color: #9b6bff; text-shadow: 0 0 10px #7700ff; }
.item-chip[data-type*="Dagger"] i { color: #c0c0c0; text-shadow: 0 0 10px #ffffff; }
.item-chip[data-type*="Spear"] i { color: #cd7f32; text-shadow: 0 0 10px #ffaa00; }
.item-chip[data-type*="Gauntlets"] i { color: #a52a2a; text-shadow: 0 0 10px #ff3300; }
.item-chip[data-type*="Cloak"] i { color: #4a6b8f; text-shadow: 0 0 10px #0066ff; }
.item-chip[data-type*="Crown"] i { color: #ffbf00; text-shadow: 0 0 10px #ffaa00; }
.item-chip[data-type*="Orb"] i { color: #9b30ff; text-shadow: 0 0 10px #aa00ff; }
.item-chip[data-type*="Tome"] i { color: #d4af37; text-shadow: 0 0 10px #ffaa00; }

.infinity-badge {
background: linear-gradient(145deg, #ffd966, #f2b807);
color: #1f0f3a;
font-weight: 900;
padding: 0.3rem 1rem;
border-radius: 30px;
margin-left: 1rem;
box-shadow: 0 0 20px gold;
animation: shine 1.5s infinite alternate;
}

.biodata-box {
margin-top: 1.5rem;
padding: 1.5rem;
background: #2b1c0eb3;
border-radius: 30px;
border-left: 8px solid #e59b4a;
font-style: italic;
color: #fae1b6;
box-shadow: 0 10px 20px #00000040;
font-size: 1.1rem;
line-height: 1.6;
position: relative;
transition: all 0.3s ease;
}

.biodata-box:hover {
border-left-color: #ffaa33;
transform: scale(1.02);
}

.biodata-box i {
color: #ffb347;
margin-right: 10px;
}

.details-container {
background: #2b1b0eb3;
border-radius: 40px;
padding: 2rem;
border: 1px solid #b87a3a;
margin-top: 1rem;
max-height: 600px;
overflow-y: auto;
color: #f3ddc1;
animation: slideIn 0.5s ease;
}

@keyframes slideIn {
from { opacity: 0; transform: translateY(20px); }
to { opacity: 1; transform: translateY(0); }
}

.details-section {
margin-bottom: 2rem;
}

.details-section h2 {
color: #ffd7a5;
border-left: 6px solid #e59b4a;
padding-left: 1rem;
margin-bottom: 1rem;
font-size: 1.8rem;
}

.details-section p {
margin-bottom: 0.8rem;
line-height: 1.7;
color: #f3dabc;
}

.details-section ul {
list-style: none;
display: flex;
flex-wrap: wrap;
gap: 0.8rem;
}

.details-section li {
background: #3f2b16;
padding: 0.5rem 1.2rem;
border-radius: 30px;
border: 1px solid #b87333;
font-size: 0.95rem;
color: #ffdebc;
transition: all 0.3s ease;
}

.details-section li:hover {
transform: translateX(5px) scale(1.05);
border-color: #ffaa33;
box-shadow: 0 0 15px #ffaa33;
}

.details-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
gap: 1rem;
}

.detail-item {
background: #352415;
border-radius: 20px;
padding: 1rem;
border-left: 5px solid #e59b4a;
transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.detail-item:hover {
transform: translateY(-5px) scale(1.02);
border-left-color: #ffaa33;
box-shadow: 0 10px 20px rgba(255, 170, 51, 0.3);
}

.detail-item strong {
color: #ffb347;
display: block;
margin-bottom: 0.5rem;
font-size: 1.2rem;
}

footer {
margin-top: 2rem;
text-align: center;
font-size: 0.9rem;
color: #b28a5c;
}

.loading {
text-align: center;
padding: 2rem;
color: #f7bc6b;
}

/* Canvas untuk spell effects */
#spellCanvas {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
pointer-events: none;
z-index: 9995;
}

/* Portal glow */
.portal-glow {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: radial-gradient(circle at var(--x, 50%) var(--y, 50%), rgba(170, 68, 255, 0.4) 0%, transparent 70%);
pointer-events: none;
z-index: 9994;
opacity: 0;
transition: opacity 0.3s ease;
}

.portal-glow.active {
opacity: 1;
}
</style>
</head>
<body>

<!-- Portal overlay elements -->
<div class="portal-overlay" id="portalOverlay"></div>
<div class="portal-spiral" id="portalSpiral"></div>
<div class="portal-glow" id="portalGlow"></div>
<div class="portal-dots" id="portalDots"></div>

<!-- Particles container -->
<div id="particles-js"></div>

<!-- Canvas untuk spell effects -->
<canvas id="spellCanvas"></canvas>

<!-- Floating decorative elements -->
<div class="floating-element" style="top: 10%; left: 5%;"></div>
<div class="floating-element" style="top: 70%; right: 5%; animation-delay: -5s;"></div>
<div class="floating-element" style="top: 30%; right: 10%; animation-delay: -10s;"></div>

<div class="card">
<!-- Audio Control - Ditambahkan -->
<div class="audio-control">
    <select id="audioSourceSelect" class="audio-select">
        <option value="default">üéµ Lagu Fantasi Default</option>
        <option value="fantasy1">üéµ Lagu Petualangan</option>
        <option value="fantasy2">üéµ Lagu Epik</option>
        <option value="youtube">üéµ YouTube (Custom)</option>
    </select>
    <button id="musicBtn" class="music-btn">
        <i class="fas fa-music"></i>
        <span id="musicStatus">Putar Musik</span>
    </button>
</div>
<input type="text" id="customUrlInput" class="custom-url-input" placeholder="Masukkan URL YouTube (contoh: https://youtu.be/xxx)">

<h1>‚öîÔ∏è AGGRE TO ISEKAI ‚öîÔ∏è</h1>
<div class="sub"><i class="fas fa-map-pin"></i> Bikin Karakter Isekai Lu dengan Gacha disini :v <i class="fas fa-map-pin"></i></div>

<!-- Tombol navigasi -->
<div class="btn-group">
<button class="isekai-btn" id="isekaiBtn">
<div class="fingerprint-icon">
<i class="fas fa-fingerprint"></i>
<div class="ripple-circle"></div>
<div class="ripple-circle"></div>
<div class="ripple-circle"></div>
</div>
<span>Tempel Jempol untuk Isekai</span>
<i class="fas fa-arrow-right"></i>
</button>
<button class="detail-btn" id="detailBtn"><i class="fas fa-book-open"></i> Rincian & Penjelasan</button>
</div>

<!-- Halaman Generator (Page 1) -->
<div id="generatorPage" class="page">
<div id="resultArea">
<div class="loading"><i class="fas fa-spinner fa-pulse"></i> Sabar nyed ... lagi dibikinin jadi apa :v</div>
</div>
</div>

<!-- Halaman Rincian (Page 2) -->
<div id="detailsPage" class="page hidden">
<button class="back-btn" id="backBtn"><i class="fas fa-arrow-left"></i> Kembali ke Generator</button>
<div class="details-container">
<!-- Konten details (sama seperti sebelumnya) -->
<div class="details-section">
<h2><i class="fas fa-shield-alt"></i> Role ‚Äì Peran Utama (40+ Role)</h2>
<p>Role menentukan gaya bertarung dan posisi dalam party. Berikut penjelasan rinci setiap role:</p>
<div class="details-grid">
<div class="detail-item"><strong>Knight</strong> - Tank dengan pertahanan tertinggi, ahli melindungi rekan. Armor tebal, shield besar.</div>
<div class="detail-item"><strong>Magicer</strong> - Penyihir elemen (api/air/angin/tanah). Damage sihir besar, fisik lemah.</div>
<div class="detail-item"><strong>Alchemist</strong> - Meracik ramuan, buff, debuff. Bisa mengubah item menjadi senjata.</div>
<div class="detail-item"><strong>Archer</strong> - Serangan jarak jauh dengan busur, akurat dan kritis. Biasanya lincah.</div>
<div class="detail-item"><strong>Swordsman</strong> - Pedang satu tangan, seimbang antara ofensif dan defensif.</div>
<div class="detail-item"><strong>Berserker</strong> - Damage fisik gila-gilaan, pertahanan rendah. Makin rendah HP makin kuat.</div>
<div class="detail-item"><strong>Paladin</strong> - Knight suci dengan sihir penyembuhan. Bisa tank dan heal.</div>
<div class="detail-item"><strong>Dark Knight</strong> - Knight kegelapan, menggunakan darah atau kekuatan iblis. Damage tinggi.</div>
<div class="detail-item"><strong>Assassin</strong> - Serangan cepat, critical tinggi, bisa menghilang. One-hit kill specialist.</div>
<div class="detail-item"><strong>Ninja</strong> - Mirip assassin tapi dengan jurus rahasia dan shuriken. Lincah dan sulit ditangkap.</div>
<div class="detail-item"><strong>Samurai</strong> - Pendekar pedang dengan bushido, serangan beruntun, armor sedang.</div>
<div class="detail-item"><strong>Monk</strong> - Petarung tangan kosong, pertahanan batin tinggi, bisa menyembuhkan diri.</div>
<div class="detail-item"><strong>Priest</strong> - Healer murni, bisa menghidupkan rekan, anti-undead.</div>
<div class="detail-item"><strong>Bishop</strong> - Versi lebih kuat dari Priest, punya sihir ofensif ringan.</div>
<div class="detail-item"><strong>Shaman</strong> - Memanggil roh, memberikan totem buff, elemen alam.</div>
<div class="detail-item"><strong>Druid</strong> - Berubah menjadi hewan, mengendalikan alam, heal dan damage.</div>
<div class="detail-item"><strong>Summoner</strong> - Memanggil monster untuk bertarung, bisa berbagai tipe.</div>
<div class="detail-item"><strong>Necromancer</strong> - Membangkitkan undead, mengendalikan kegelapan, serangan racun.</div>
<div class="detail-item"><strong>Mage</strong> - Penyihir umum, banyak varian elemen. (spesialisasi)</div>
<div class="detail-item"><strong>Wizard</strong> - Mage yang lebih fokus pada sihir destruktif.</div>
<div class="detail-item"><strong>Sorcerer</strong> - Mage dengan sihir chaos, tidak terduga.</div>
<div class="detail-item"><strong>Spellblade</strong> - Menggabungkan pedang dan sihir, bisa enchant senjata.</div>
<div class="detail-item"><strong>Ranger</strong> - Ahli bertahan hidup di alam liar, panah + perangkap.</div>
<div class="detail-item"><strong>Hunter</strong> - Pemburu monster, tahu kelemahan musuh.</div>
<div class="detail-item"><strong>Thief</strong> - Mencuri, membuka kunci, hindari musuh. Damage sedang.</div>
<div class="detail-item"><strong>Bard</strong> - Memberikan buff melalui musik, juga bisa debuff musuh.</div>
<div class="detail-item"><strong>Dancer</strong> - Gerakan memikat, buff party, kadang menyembuhkan.</div>
<div class="detail-item"><strong>Merchant</strong> - Bisa menghasilkan uang, menjual barang, beli item unik.</div>
<div class="detail-item"><strong>Blacksmith</strong> - Memperbaiki dan meningkatkan perlengkapan, bisa bertarung dengan palu.</div>
<div class="detail-item"><strong>Tamer</strong> - Menjinakkan monster, menjadikan mereka pet.</div>
<div class="detail-item"><strong>Lancer</strong> - Pengguna tombak, jangkauan panjang, kuat melawan penunggang.</div>
<div class="detail-item"><strong>Gunner</strong> - Senjata api (jika dunia isekai ada), damage fisik jarak jauh.</div>
<div class="detail-item"><strong>Cleric</strong> - Mirip priest tapi lebih militer, bisa menggunakan armor.</div>
<div class="detail-item"><strong>Sage</strong> - Mage bijaksana, menguasai banyak sihir, sering jadi penasihat.</div>
<div class="detail-item"><strong>Archmage</strong> - Mage legendaris, sihir area luas.</div>
<div class="detail-item"><strong>Warlock</strong> - Terikat dengan iblis, mendapatkan kekuatan dengan harga mahal.</div>
<div class="detail-item"><strong>Illusionist</strong> - Menciptakan ilusi, mengelabui musuh.</div>
<div class="detail-item"><strong>Battlemage</strong> - Mage dengan baju besi, bertarung di garis depan.</div>
<div class="detail-item"><strong>Templar</strong> - Ksatria suci dengan sihir, anti-iblis.</div>
<div class="detail-item"><strong>Valkyrie</strong> - Prajurit wanita legendaris, bisa terbang, memanggil petir.</div>
<div class="detail-item"><strong>Reaper</strong> - Penjemput nyawa, serangan instan kill.</div>
</div>
</div>

<!-- JOB CLASS SECTION -->
<div class="details-section">
<h2><i class="fas fa-briefcase"></i> Job Class ‚Äì Spesialisasi Unik (16+ Job)</h2>
<p>Job class memberikan skill khusus dan membedakan karakter meskipun role sama. Berikut detail tiap job class:</p>
<ul style="display: block; list-style: disc; padding-left: 1.5rem;">
<li><strong>Warrior</strong> ‚Äì Pakar segala senjata fisik, bisa menggunakan berbagai armor.</li>
<li><strong>Mage</strong> ‚Äì Menguasai elemen dasar (api, es, petir). Dapat mempelajari sihir dari scroll.</li>
<li><strong>Thief</strong> ‚Äì Skill mencuri, membuka kunci, dan menghindar. Cukup lincah.</li>
<li><strong>Priest</strong> ‚Äì Heal, buff, dan sihir suci. Dapat mengusir undead.</li>
<li><strong>Paladin</strong> ‚Äì Gabungan Knight dan Priest. Bisa tank dan heal.</li>
<li><strong>Dark Knight</strong> ‚Äì Kekuatan dari darah atau kegelapan. Semakin sakit semakin kuat.</li>
<li><strong>Ranger</strong> ‚Äì Spesialis panah dan perangkap. Bisa track musuh.</li>
<li><strong>Summoner</strong> ‚Äì Panggil monster dari kontrak. Butuh mana besar.</li>
<li><strong>Berserker</strong> ‚Äì Semakin rendah HP, semakin besar damage. Bisa masuk mode ‚Äúrage‚Äù.</li>
<li><strong>Sage</strong> ‚Äì Menguasai semua elemen sihir, tapi lemah fisik.</li>
<li><strong>Ninja</strong> ‚Äì Bisa menghilang, serangan bayangan, racun.</li>
<li><strong>Dancer</strong> ‚Äì Memberikan buff melalui tarian, juga bisa menyembuhkan.</li>
<li><strong>Gambler</strong> ‚Äì Mengandalkan keberuntungan, efek acak bisa sangat menguntungkan atau merugikan.</li>
<li><strong>Spell Fencer</strong> ‚Äì Menyihir pedangnya, bisa mengubah elemen serangan.</li>
<li><strong>Beast Tamer</strong> ‚Äì Menjinakkan beast, bisa bertarung bersama.</li>
<li><strong>Soul Reaper</strong> ‚Äì Memanen jiwa musuh untuk memperkuat diri. Jurus kematian.</li>
</ul>
</div>

<!-- TIER ITEM SECTION -->
<div class="details-section">
<h2><i class="fas fa-star"></i> Tier Item ‚Äì Tingkat Kelangkaan & Kekuatan</h2>
<p>Setiap item memiliki tier yang mempengaruhi stat dan efeknya. Berikut penjelasan lengkap dari terendah ke tertinggi:</p>
<div class="details-grid">
<div class="detail-item"><span class="tier-badge tier-E">E</span> <strong>Common (E)</strong> ‚Äì Item biasa, mudah ditemukan di toko desa. Hanya memberikan sedikit bonus.</div>
<div class="detail-item"><span class="tier-badge tier-D">D</span> <strong>Uncommon (D)</strong> ‚Äì Sedikit lebih baik, biasanya hasil craft atau monster biasa.</div>
<div class="detail-item"><span class="tier-badge tier-C">C</span> <strong>Rare (C)</strong> ‚Äì Mulai berharga. Dijatuhkan oleh mini-boss atau dungeon tingkat rendah.</div>
<div class="detail-item"><span class="tier-badge tier-B">B</span> <strong>Super Rare (B)</strong> ‚Äì Kuat, punya efek tambahan. Biasanya dari boss atau quest langka.</div>
<div class="detail-item"><span class="tier-badge tier-A">A</span> <strong>Epic (A)</strong> ‚Äì Sangat kuat, bisa mengubah jalannya pertarungan. Hanya dari raid boss atau event.</div>
<div class="detail-item"><span class="tier-badge tier-S">S</span> <strong>Legendary (S)</strong> ‚Äì Legendaris, punya nama unik dan sejarah. Dapat meningkatkan kekuatan pemilik secara drastis.</div>
<div class="detail-item"><span class="tier-badge tier-SSR">SSR</span> <strong>Mythic (SSR)</strong> ‚Äì Item dewa, hanya segelintir orang yang memilikinya. Efeknya bisa mengubah realitas (misal: menghidupkan kembali).</div>
<div class="detail-item"><span class="tier-badge tier-SSRplus">SSR++</span> <strong>Godly (SSR++)</strong> ‚Äì Puncak segalanya. Item dengan tier ini biasanya adalah artifact penciptaan, memberikan kekuatan tak terbatas, dan hanya dimiliki oleh satu karakter dalam satu waktu.</div>
</div>
<p style="margin-top: 1rem;">Setiap item yang muncul di karakter akan memiliki tier yang ditampilkan dengan warna badge.</p>
</div>

<!-- LEVEL SECTION -->
<div class="details-section">
<h2><i class="fas fa-level-up-alt"></i> Level & Fenomena ‚àû Infinity</h2>
<p>Level karakter berkisar dari 1 hingga 999. Namun ada peluang sangat langka (1/500) mendapatkan level <strong>‚àû Infinity</strong>, yang menandakan karakter tersebut sudah melampaui batas duniawi. Karakter dengan level ‚àû biasanya memiliki kekuatan dewa dan tidak terikat oleh aturan level biasa. Item dan skill mereka juga cenderung berada di tier tertinggi. Dalam tampilan, level ‚àû akan diberi badge khusus <span class="infinity-badge"><i class="fas fa-star"></i> LEGENDARY</span>.</p>
</div>

<!-- ITEM & EQUIPMENT SECTION -->
<div class="details-section">
<h2><i class="fas fa-chess-board"></i> Item & Equipment</h2>
<p>Setiap karakter membawa 4‚Äì7 item yang terdiri dari berbagai jenis. Berikut jenis-jenis item yang bisa muncul:</p>
<ul style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
<li>Helmet</li><li>Chestplate</li><li>Gauntlets</li><li>Boots</li><li>Shield</li><li>Sword</li><li>Axe</li><li>Bow</li>
<li>Staff</li><li>Dagger</li><li>Spear</li><li>Wand</li><li>Ring</li><li>Amulet</li><li>Cloak</li><li>Gloves</li>
<li>Belt</li><li>Greaves</li><li>Pauldrons</li><li>Crown</li><li>Orb</li><li>Tome</li><li>Quiver</li><li>Arrow</li>
</ul>
<p>Nama item digabungkan dengan kata sifat (misal: <em>Dragonbone Sword</em>, <em>Elven Bow</em>) yang juga mempengaruhi tema item. Kombinasi antara adjektif dan jenis item menghasilkan variasi tak terbatas.</p>
</div>

<!-- STATISTIK SECTION (BARU) -->
<div class="details-section">
<h2><i class="fas fa-chart-line"></i> Statistik Karakter</h2>
<p>Setiap karakter memiliki 12 stat utama dengan nilai acak antara 10 hingga 9.999. Setiap stat memiliki peluang 1/500 untuk menjadi <strong class="infinity-badge-small">‚àû Infinity</strong> yang menandakan stat tersebut telah melampaui batas duniawi.</p>

<div class="details-grid">
<div class="detail-item"><strong><i class="fas fa-heart"></i> HP (Health Points)</strong> - Ketahanan hidup karakter. Makin tinggi makin kuat menahan damage.</div>
<div class="detail-item"><strong><i class="fas fa-crosshairs"></i> Attack</strong> - Kekuatan serangan fisik. Menentukan damage dasar.</div>
<div class="detail-item"><strong><i class="fas fa-shield"></i> Defense</strong> - Ketahanan terhadap serangan fisik. Mengurangi damage yang diterima.</div>
<div class="detail-item"><strong><i class="fas fa-running"></i> Speed</strong> - Kecepatan bergerak dan inisiatif dalam bertarung.</div>
<div class="detail-item"><strong><i class="fas fa-magic"></i> Mana</strong> - Energi sihir untuk mengeluarkan skill.</div>
<div class="detail-item"><strong><i class="fas fa-bolt"></i> Power</strong> - Kekuatan sihir atau fisik murni.</div>
<div class="detail-item"><strong><i class="fas fa-brain"></i> IQ</strong> - Kecerdasan intelektual. Mempengaruhi strategi dan pembelajaran skill.</div>
<div class="detail-item"><strong><i class="fas fa-chess-queen"></i> Battle IQ</strong> - Kecerdasan bertarung. Kemampuan membaca musuh.</div>
<div class="detail-item"><strong><i class="fas fa-fist-raised"></i> Combat Power</strong> - Gabungan kekuatan tempur secara keseluruhan.</div>
<div class="detail-item"><strong><i class="fas fa-ghost"></i> Dodge</strong> - Kemampuan menghindar dari serangan.</div>
<div class="detail-item"><strong><i class="fas fa-bullseye"></i> Accuracy</strong> - Ketepatan serangan, mengurangi chance miss.</div>
<div class="detail-item"><strong><i class="fas fa-star"></i> Critical</strong> - Peluang serangan kritis (damage berlipat).</div>
</div>

<p style="margin-top:1rem; background: #3f2b16; padding: 1rem; border-radius: 20px;">
<i class="fas fa-info-circle" style="color: #ffb347;"></i> <strong>Sistem ‚àû Infinity:</strong> Setiap stat di-roll secara independen dengan peluang 1/500. Jika berhasil, stat tersebut menjadi ‚àû yang berarti tak terbatas dan tidak bisa diukur dengan angka biasa. Karakter dengan banyak stat ‚àû dianggap sebagai makhluk legendaris setara dewa. Peluang mendapatkan setidaknya satu stat ‚àû adalah sekitar 2.37% per karakter.
</p>
</div>
</div>
</div>

<footer>‚ú® Note : *Kalo abis Gacha pertama Wajib SekrinShot,soalnya disitulah lu bakal jadi karakternya :v ‚ú®</footer>
</div>

<!-- Audio element -->
<audio id="bgMusic" loop preload="auto"></audio>

<script>
(function() {
// ========== AUDIO CONTROL ==========
const bgMusic = document.getElementById('bgMusic');
const musicBtn = document.getElementById('musicBtn');
const musicStatus = document.getElementById('musicStatus');
const audioSelect = document.getElementById('audioSourceSelect');
const customUrlInput = document.getElementById('customUrlInput');
let isMusicPlaying = false;
let ytPlayer = null;

// Daftar sumber audio yang tersedia
const audioSources = {
    default: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3',
    fantasy1: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3',
    fantasy2: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3',
    youtube: null
};

// Fungsi untuk memuat audio dari sumber
function loadAudioFromSource(source) {
    // Hapus semua source yang ada
    while (bgMusic.firstChild) {
        bgMusic.removeChild(bgMusic.firstChild);
    }
    
    // Buat source baru
    const sourceElement = document.createElement('source');
    sourceElement.src = source;
    sourceElement.type = 'audio/mpeg';
    bgMusic.appendChild(sourceElement);
    
    // Reload audio
    bgMusic.load();
}

// Fungsi untuk extract YouTube ID
function extractYouTubeId(url) {
    const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
    const match = url.match(regExp);
    return (match && match[2].length === 11) ? match[2] : null;
}

// Load YouTube API
function loadYouTubeAPI() {
    if (window.YT) return;
    
    const tag = document.createElement('script');
    tag.src = 'https://www.youtube.com/iframe_api';
    const firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
}

// YouTube player setup
window.onYouTubeIframeAPIReady = function() {
    console.log('YouTube API ready');
};

function setupYouTubePlayer(videoId) {
    if (!window.YT) {
        loadYouTubeAPI();
        setTimeout(() => setupYouTubePlayer(videoId), 500);
        return;
    }
    
    if (ytPlayer) {
        ytPlayer.destroy();
    }
    
    // Buat elemen untuk YouTube player
    let playerDiv = document.getElementById('youtube-player');
    if (!playerDiv) {
        playerDiv = document.createElement('div');
        playerDiv.id = 'youtube-player';
        playerDiv.style.display = 'none';
        document.body.appendChild(playerDiv);
    }
    
    ytPlayer = new YT.Player('youtube-player', {
        height: '0',
        width: '0',
        videoId: videoId,
        playerVars: {
            'autoplay': 0,
            'loop': 1,
            'playlist': videoId,
            'controls': 0,
            'disablekb': 1
        },
        events: {
            'onReady': (event) => {
                console.log('YouTube player ready');
                if (isMusicPlaying) {
                    event.target.playVideo();
                }
            },
            'onStateChange': (event) => {
                // Loop manual jika video berakhir
                if (event.data === YT.PlayerState.ENDED && isMusicPlaying) {
                    event.target.playVideo();
                }
            },
            'onError': (event) => {
                console.error('YouTube error:', event);
                musicStatus.textContent = 'Gagal';
                musicBtn.disabled = true;
            }
        }
    });
}

// Handle perubahan sumber audio
audioSelect.addEventListener('change', (e) => {
    if (e.target.value === 'youtube') {
        customUrlInput.style.display = 'block';
        // Stop audio biasa jika sedang play
        if (isMusicPlaying) {
            bgMusic.pause();
            isMusicPlaying = false;
            musicStatus.textContent = 'Putar Musik';
            musicBtn.classList.remove('playing');
        }
    } else {
        customUrlInput.style.display = 'none';
        // Hancurkan YouTube player jika ada
        if (ytPlayer) {
            ytPlayer.destroy();
            ytPlayer = null;
        }
        // Load audio biasa
        loadAudioFromSource(audioSources[e.target.value]);
        // Reset status
        if (isMusicPlaying) {
            bgMusic.play().catch(e => console.error('Gagal play audio:', e));
        }
    }
});

// Handle custom URL (YouTube)
customUrlInput.addEventListener('change', (e) => {
    const url = e.target.value.trim();
    if (!url) return;
    
    const videoId = extractYouTubeId(url);
    if (videoId) {
        // Load YouTube API dan setup player
        loadYouTubeAPI();
        setupYouTubePlayer(videoId);
        musicBtn.disabled = false;
        musicStatus.textContent = 'Putar Musik';
        musicBtn.classList.remove('playing');
        isMusicPlaying = false;
    } else {
        alert('URL YouTube tidak valid!');
    }
});

// Tombol play/pause
musicBtn.addEventListener('click', () => {
    const currentSource = audioSelect.value;
    
    if (currentSource === 'youtube' && customUrlInput.value) {
        // YouTube mode
        if (!ytPlayer) {
            alert('YouTube player belum siap. Silakan tunggu atau masukkan URL valid.');
            return;
        }
        
        if (isMusicPlaying) {
            ytPlayer.pauseVideo();
            musicStatus.textContent = 'Putar Musik';
            musicBtn.classList.remove('playing');
        } else {
            ytPlayer.playVideo();
            musicStatus.textContent = 'Hentikan Musik';
            musicBtn.classList.add('playing');
        }
        isMusicPlaying = !isMusicPlaying;
    } else {
        // Audio biasa mode
        if (isMusicPlaying) {
            bgMusic.pause();
            musicStatus.textContent = 'Putar Musik';
            musicBtn.classList.remove('playing');
        } else {
            bgMusic.play()
                .then(() => {
                    musicStatus.textContent = 'Hentikan Musik';
                    musicBtn.classList.add('playing');
                })
                .catch(error => {
                    console.error('Gagal memutar audio:', error);
                    alert('Gagal memutar audio. Coba sumber lain.');
                });
        }
        isMusicPlaying = !isMusicPlaying;
    }
});

// Load default audio
loadAudioFromSource(audioSources.default);

// Handle error audio
bgMusic.addEventListener('error', (e) => {
    console.error('Error loading audio:', e);
    musicStatus.textContent = 'Gagal';
    musicBtn.disabled = true;
});

// ========== SPELL EFFECT CANVAS ==========
const canvas = document.getElementById('spellCanvas');
const ctx = canvas.getContext('2d');
let particles = [];
const MAX_PARTICLES = 200;

function resizeCanvas() {
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

class SpellParticle {
constructor(x, y, color) {
this.x = x;
this.y = y;
this.vx = (Math.random() - 0.5) * 6;
this.vy = (Math.random() - 0.5) * 6;
this.size = Math.random() * 3 + 1;
this.color = color;
this.life = 1;
this.decay = 0.01 + Math.random() * 0.02;
}

update() {
this.x += this.vx;
this.y += this.vy;
this.vy += 0.02;
this.life -= this.decay;
}

draw() {
ctx.globalAlpha = this.life * 0.8;
ctx.beginPath();
ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
ctx.fillStyle = this.color;
ctx.fill();
ctx.shadowColor = this.color;
ctx.shadowBlur = 10;
ctx.fill();
ctx.shadowBlur = 0;
}
}

function createSpellEffect(x, y, color, count = 12) {
if (particles.length > MAX_PARTICLES) return;
const newCount = Math.min(count, MAX_PARTICLES - particles.length);
for (let i = 0; i < newCount; i++) {
particles.push(new SpellParticle(x, y, color));
}
}

function animateSpells() {
ctx.clearRect(0, 0, canvas.width, canvas.height);
for (let i = particles.length - 1; i >= 0; i--) {
particles[i].update();
particles[i].draw();
if (particles[i].life <= 0) particles.splice(i, 1);
}
requestAnimationFrame(animateSpells);
}
animateSpells();

// ========== EFEK PORTAL SPIRAL ==========
const portalOverlay = document.getElementById('portalOverlay');
const portalSpiral = document.getElementById('portalSpiral');
const portalGlow = document.getElementById('portalGlow');
const portalDots = document.getElementById('portalDots');
const body = document.body;

function createPortalDots() {
portalDots.innerHTML = '';
for (let i = 0; i < 30; i++) {
const dot = document.createElement('div');
dot.className = 'portal-dot';
dot.style.animationDelay = `${i * 0.1}s`;
dot.style.left = '50%';
dot.style.top = '50%';
dot.style.transform = `rotate(${i * 12}deg) translateY(-150px)`;
portalDots.appendChild(dot);
}
}

function triggerIsekaiPortal() {
portalOverlay.classList.add('active');
portalSpiral.classList.add('active');
portalGlow.classList.add('active');
body.classList.add('isekai-mode');
createPortalDots();

const mouseHandler = (e) => {
portalGlow.style.setProperty('--x', e.clientX + 'px');
portalGlow.style.setProperty('--y', e.clientY + 'px');
};
document.addEventListener('mousemove', mouseHandler);

setTimeout(() => {
portalOverlay.classList.remove('active');
portalSpiral.classList.remove('active');
portalGlow.classList.remove('active');
body.classList.remove('isekai-mode');
document.removeEventListener('mousemove', mouseHandler);
portalDots.innerHTML = '';
}, 1800);
}

// ========== NAMA INDONESIA dengan gender spesifik ==========
const maleFirstNames = [
"Asep", "Udin", "Budi", "Joko", "Agus", "Hendra", "Rudi", "Indra", "Eko", "Bayu",
"Yoga", "Putra", "Wijaya", "Santoso", "Hidayat", "Setiawan", "Gilang", "Lukman",
"Maman", "Oman", "Rizky", "Saepul", "Taufik", "Ujang", "Wawan", "Yusuf", "Dimas",
"Fajar", "Guntur", "Heru", "Irfan", "Jajang", "Kurnia", "Lutfi", "Maulana", "Nanda",
"Oka", "Pandu", "Qori", "Rangga", "Sandy", "Teguh", "Umar", "Vicky", "Wildan"
];

const femaleFirstNames = [
"Siti", "Yanti", "Rina", "Dewi", "Sri", "Tuti", "Maya", "Wulan", "Nur", "Fitri",
"Ratna", "Sari", "Lestari", "Putri", "Kusuma", "Ningsih", "Utami", "Intan", "Karina",
"Nana", "Popon", "Vina", "Zahra", "Aisyah", "Bunga", "Cantika", "Dian", "Elsa",
"Farah", "Gita", "Hana", "Indah", "Juwita", "Kartika", "Laras", "Mutiara", "Nadia",
"Olivia", "Puspita", "Queen", "Raisa", "Sekar", "Tara", "Umi", "Winda", "Yulia"
];

const lastNames = [
"Sunandar", "Saepudin", "Nurhaliza", "Purnama", "Kusuma", "Wijaya", "Santoso",
"Hidayat", "Setiawan", "Siregar", "Nasution", "Ginting", "Tambunan", "Saragih",
"Sinaga", "Sihombing", "Sitompul", "Siahaan", "Simanjuntak", "Sitorus", "Siburian",
"Situmeang", "Sitohang", "Sirait", "Sitepu", "Hasibuan", "Harahap", "Tan", "Lim",
"Gunawan", "Halim", "Salim", "Kurniawan", "Prasetyo", "Nugroho", "Wibowo", "Saputra",
"Pamungkas", "Cahyono", "Susanto", "Suryadi", "Suryana", "Maulana", "Ramadhan",
"Fauzi", "Hasan", "Husen", "Abdullah", "Rahman", "Rasyid", "Sutisna", "Suparman"
];

const roles = [
"Knight", "Magicer", "Alchemist", "Archer", "Swordsman", "Berserker", "Paladin", "Dark Knight",
"Assassin", "Ninja", "Samurai", "Monk", "Priest", "Bishop", "Shaman", "Druid", "Summoner",
"Necromancer", "Mage", "Wizard", "Sorcerer", "Spellblade", "Ranger", "Hunter", "Thief",
"Bard", "Dancer", "Merchant", "Blacksmith", "Tamer", "Lancer", "Gunner", "Cleric",
"Sage", "Archmage", "Warlock", "Illusionist", "Battlemage", "Templar", "Valkyrie", "Reaper"
];

const jobClasses = [
"Warrior", "Mage", "Thief", "Priest", "Paladin", "Dark Knight", "Ranger", "Summoner",
"Berserker", "Sage", "Ninja", "Dancer", "Gambler", "Spell Fencer", "Beast Tamer", "Soul Reaper"
];

const itemTypes = [
"Helmet", "Chestplate", "Gauntlets", "Boots", "Shield", "Sword", "Axe", "Bow",
"Staff", "Dagger", "Spear", "Wand", "Ring", "Amulet", "Cloak", "Gloves",
"Belt", "Greaves", "Pauldrons", "Crown", "Orb", "Tome", "Quiver", "Arrow"
];

const itemIconMap = {
"Helmet": "fa-helmet-battle", 
"Chestplate": "fa-tshirt", 
"Gauntlets": "fa-hand-fist", 
"Boots": "fa-boots",
"Shield": "fa-shield-halved", 
"Sword": "fa-sword", 
"Axe": "fa-axe", 
"Bow": "fa-bow-arrow",
"Staff": "fa-staff", 
"Dagger": "fa-knife", 
"Spear": "fa-pitchfork", 
"Wand": "fa-wand",
"Ring": "fa-ring", 
"Amulet": "fa-gem", 
"Cloak": "fa-cloak", 
"Gloves": "fa-hand",
"Belt": "fa-belt", 
"Greaves": "fa-shield", 
"Pauldrons": "fa-shield", 
"Crown": "fa-crown",
"Orb": "fa-circle", 
"Tome": "fa-book", 
"Quiver": "fa-quiver", 
"Arrow": "fa-arrow"
};

const tierList = ["E", "D", "C", "B", "A", "S", "SSR", "SSR++"];
const itemAdjectives = [
"Rusty", "Iron", "Steel", "Mithril", "Orichalcum", "Crystal", "Obsidian", "Dragonbone",
"Elven", "Dwarven", "Demonic", "Angelic", "Shadow", "Flaming", "Frozen", "Thunder",
"Mystic", "Arcane", "Soul", "Cursed", "Blessed", "Royal", "Ancient", "Eternal"
];

const genders = ["Pria", "Wanita"];

const statDefinitions = [
{ key: 'hp', label: 'HP', icon: 'fa-heart' },
{ key: 'attack', label: 'Attack', icon: 'fa-crosshairs' },
{ key: 'defense', label: 'Defense', icon: 'fa-shield' },
{ key: 'speed', label: 'Speed', icon: 'fa-running' },
{ key: 'mana', label: 'Mana', icon: 'fa-magic' },
{ key: 'power', label: 'Power', icon: 'fa-bolt' },
{ key: 'iq', label: 'IQ', icon: 'fa-brain' },
{ key: 'battleIQ', label: 'Battle IQ', icon: 'fa-chess-queen' },
{ key: 'combatPower', label: 'Combat Power', icon: 'fa-fist-raised' },
{ key: 'dodge', label: 'Dodge', icon: 'fa-ghost' },
{ key: 'accuracy', label: 'Accuracy', icon: 'fa-bullseye' },
{ key: 'critical', label: 'Critical', icon: 'fa-star' }
];

const biodataTemplates = [
"{name} tuh seorang {role} dari antah berantah. {subjek} pernah tuh {peristiwa} dan sekarang maunya sih {tujuan}. Ya begitulah Hehe.",
"Jadi dulu banget, {name} cuma {role} biasaa. Tapi abis {peristiwa}, {subjek} dapet job class {jobClass} nih dan mulai petualangannya. Pokoknya kece abis dah nih orang!",
"{name} dikenal sebagai {role} yang begituwlah. Konon katanya sih {subjek} pernah {peristiwa}. Sekarang levelnya dah {level} aja dan bawa {itemCount} item andalannya tuh. Gacor abiss dah!",
"Adalah nasib,adalah takdir membawa {name} menjadi seorang {jobClass} dengan role {role}. {subjek} suka ngomong gini nih: '{quote}'.",
"Di dunia isekai ini, {name}ÈáçÁîü (Reinkernasi) sebagai {role}. Ceritanya cukup nyeleneh broo: {peristiwa}. Sekarang sih {subjek} lagi ngejar kemauannya buat {tujuan}. OK Gas terus dah pokoknya!",
"Dengan senjata andalannya {item1}, {name} udah by one dengan banyak orang. {subjek} adalah satu-satunya {role} yang bisa make {jobClass}. Etdahh, boleh juga nih orang!",
"{name} (levelnya {level}) punya mimpi buat jadi versi yang terbaik bagi dirinya. Sebagai seorang {role}, {subjek} keliaran kesana-sini sambil nyari arti hidup yang sebenarnya. Filosofi juga nih orang.",
"Katanya sih,si {name} titisan dewa. {subjek} lahir nih dengan kekuatan {jobClass} dan memilih sebagai {role}. Tapi ya gitulah, {subjek} harus ngadapin berbagai cobaan yang berat. Awwwhuu kasihann.",
"Bro, kenalin nih {name}. Dia tuh {role} level {level} dengan job {jobClass}. Pernah nih {peristiwa}, sekarang sih maunya {tujuan}. Pokoknya kocak abis nih beliau!",
"{name} nih orangnya cupu ternyata suhu {role} kedoknya CEO yang lagi menyamar. Pas lagi {peristiwa} tuh, tiba-tiba ngebet banget ngidam buat dapetin job {jobClass}. ada katanya: '{quote}'"
];

const peristiwaList = [
"nyelametin koruptor dari hukuman mati", "ditikung sama temennya sendiri", "nemu artefak kuno legendaris dirumahnya Sahroni",
"dulu kekunci diwc sekolah ", "bangkitin kekuatan Raja Iblis", "kehilangan perasaan sama si dia",
"belajar sihir dari sesepuh dukun kampong", "nontonin orang-orang yang lagi pergi kerja depan teras rumah", "namatin anime One Piece dalam semalam", "ngorbanin banyak hal demi cinta,Eiiuhh juga nih orang",
"nyasar karna gak bisa baca google maps", "kepleset jatoh diketawain wibu", "makan buah iblis misterius kayak diOne Piece", "ngestalking medsos crushnya"
];

const tujuanList = [
"cari arti hidup yang sebenarnnya", "ngebubarin DPR", "nyariin One Piece di dunia ini", "lindungin begal dari hukum",
"jadi raja iblis", "ciptain dunia tanpa Koruptor", "kumpulin semua koruptor terus di genosida", "capai level ‚àû",
"jadi Tiktoker terkenal lah", "nembak crushnya sih", "bikin KUHP baru"
];

const quotes = [
"Selama masih ada sebatang rokok akan kuhadapi dunia yang kejam ini!", "Hidup seperti Larry!.", "Ragumu-rugimu,kalo gak ditendang gak bakalan Goal tuh bola.",
"Cuman di Isekai gue bisa dapetin power gak dari orang dalem! kelass.", "Sorong-papan tarik duit,buah keranji dalam perahu,suruh nyawit dia gaskan,disuruh merakyat dia tak mau", "Level cuma angka, dingin tetapi tidak kejam.",
"Senggol dongg!", "Yodaktau, gas ajalah mati tanam!", "Iri? bilang bos,hahaa."
];

const random = (arr) => arr[Math.floor(Math.random() * arr.length)];
const randomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

function generateItems() {
const count = randomInt(4, 7);
const items = [];
for (let i = 0; i < count; i++) {
const tier = random(tierList);
const type = random(itemTypes);
const adj = random(itemAdjectives);
items.push({ name: `${adj} ${type}`, tier, type });
}
return items;
}

function generateStats() {
const stats = {};
statDefinitions.forEach(def => {
const roll = randomInt(1, 500);
if (roll === 500) {
stats[def.key] = '‚àû';
} else {
stats[def.key] = randomInt(10, 9999);
}
});
return stats;
}

function generateName(gender) {
if (gender === "Pria") {
return `${random(maleFirstNames)} ${random(lastNames)}`;
} else {
return `${random(femaleFirstNames)} ${random(lastNames)}`;
}
}

function generateBiodata(char) {
let template = random(biodataTemplates);
const peristiwa = random(peristiwaList);
const tujuan = random(tujuanList);
const quote = random(quotes);
const item1 = char.items.length > 0 ? char.items[0].name : "senjata biasa";
const itemCount = char.items.length;
const subjek = char.name.split(' ')[0];

let biodata = template
.replace(/{name}/g, char.name)
.replace(/{role}/g, char.role)
.replace(/{jobClass}/g, char.jobClass)
.replace(/{level}/g, char.level)
.replace(/{peristiwa}/g, peristiwa)
.replace(/{tujuan}/g, tujuan)
.replace(/{quote}/g, quote)
.replace(/{item1}/g, item1)
.replace(/{itemCount}/g, itemCount)
.replace(/{subjek}/g, subjek);

return biodata;
}

async function fetchImageByGender(gender) {
const endpoint = gender === "Pria" 
? 'https://nekos.best/api/v2/husbando?amount=1' 
: 'https://nekos.best/api/v2/waifu?amount=1';
try {
const response = await fetch(endpoint);
const data = await response.json();
return data.results[0].url;
} catch (error) {
console.error('Gagal ambil gambar, pakai fallback', error);
return `https://api.dicebear.com/9.x/adventurer/svg?seed=${randomInt(1,9999)}&backgroundColor=b6e3f4,c0aede,d1d4f9&scale=90`;
}
}

function getHighestTier(items) {
const tierRank = { "E":1, "D":2, "C":3, "B":4, "A":5, "S":6, "SSR":7, "SSR++":8 };
let highest = "E";
items.forEach(item => {
if (tierRank[item.tier] > tierRank[highest]) highest = item.tier;
});
return highest;
}

function getStatPercentage(value) {
if (value === '‚àû') return 100;
return Math.min(100, Math.floor((value / 9999) * 100));
}

async function generateCharacter() {
const gender = random(genders);
const name = generateName(gender);
const role = random(roles);
const jobClass = random(jobClasses);

const levelRand = randomInt(1, 500);
let level, isInfinity = false;
if (levelRand === 500) {
level = "‚àû Infinity";
isInfinity = true;
} else {
level = randomInt(1, 999).toString();
}

const items = generateItems();
const stats = generateStats();
const imageUrl = await fetchImageByGender(gender);

const char = { 
name, 
gender, 
role, 
jobClass, 
level, 
isInfinity, 
items, 
stats,
imageUrl 
};

char.biodata = generateBiodata(char);
return char;
}

function renderCharacter(char) {
const area = document.getElementById('resultArea');

let itemsHtml = '';
char.items.forEach(item => {
let tierClass = 'tier-' + item.tier.replace('+', 'plus');
const iconClass = itemIconMap[item.type] || 'fa-box';
itemsHtml += `<span class="item-chip" data-type="${item.type}"><i class="fas ${iconClass}"></i> <span class="tier-badge ${tierClass}">${item.tier}</span> ${item.name}</span>`;
});

const levelDisplay = char.isInfinity ? 
`<span class="stat-value">‚àû Infinity <span class="infinity-badge"><i class="fas fa-star"></i> LEGENDARY</span></span>` : 
`<span class="stat-value">${char.level}</span>`;

let statsHtml = '';
statDefinitions.forEach(def => {
const value = char.stats[def.key];
const isInfinity = value === '‚àû';
const percentage = isInfinity ? 100 : getStatPercentage(value);
const displayValue = isInfinity ? 
'<span class="infinity-badge-small">‚àû</span>' : 
`<span class="stat-value-number">${value.toLocaleString()}</span>`;

statsHtml += `
<div class="stat-item ${isInfinity ? 'infinity-stat' : ''}">
<div class="stat-header">
<span class="stat-name"><i class="fas ${def.icon}"></i> ${def.label}</span>
${displayValue}
</div>
<div class="stat-level-bar">
<div class="stat-level-fill" style="width: ${percentage}%;"></div>
</div>
</div>
`;
});

const highestTier = getHighestTier(char.items);
const tierClassForContainer = 'highest-tier-' + highestTier.replace('+', 'plus');

const containerHtml = `
<div class="character-container ${tierClassForContainer} isekai-enter">
<div class="avatar-section">
<div class="avatar-img">
<img src="${char.imageUrl}" alt="${char.name}" 
onerror="this.src='https://api.dicebear.com/9.x/adventurer/svg?seed=fallback${randomInt(1,999)}&backgroundColor=b6e3f4,c0aede,d1d4f9'">
</div>
<div class="char-name">${char.name}</div>
<span class="gender-badge"><i class="fas ${char.gender === 'Pria' ? 'fa-mars' : 'fa-venus'}"></i> ${char.gender}</span>
<div class="avatar-badges">
<span class="role-badge"><i class="fas fa-shield-alt"></i> ${char.role}</span>
<span class="job-badge"><i class="fas fa-briefcase"></i> ${char.jobClass}</span>
</div>
</div>
<div class="stats">
<div class="stat-line">
<span class="stat-label"><i class="fas fa-shield-alt"></i> Role</span>
<span class="stat-value">${char.role}</span>
</div>
<div class="stat-line">
<span class="stat-label"><i class="fas fa-briefcase"></i> Job Class</span>
<span class="stat-value">${char.jobClass}</span>
</div>
<div class="stat-line">
<span class="stat-label"><i class="fas fa-level-up-alt"></i> Level</span>
${levelDisplay}
</div>
<div class="stat-line" style="border-bottom: none;">
<span class="stat-label"><i class="fas fa-chess-board"></i> Equipment</span>
<div class="items-grid" style="flex:1;">
${itemsHtml}
</div>
</div>

<div class="stats-grid">
${statsHtml}
</div>

<div class="biodata-box">
<i class="fas fa-scroll"></i> ${char.biodata}
</div>
</div>
</div>
`;

area.innerHTML = containerHtml;

setTimeout(() => {
const container = document.querySelector('.character-container');
if (container) container.classList.remove('isekai-enter');
}, 1200);
}

// ========== PARTICLES.JS SETUP ==========
particlesJS('particles-js', {
particles: {
number: { value: 80, density: { enable: true, value_area: 800 } },
color: { value: ['#ff3a3a', '#ffcc00', '#8bb4ff', '#ff6acb', '#b48bff'] },
shape: { type: ['circle', 'triangle'], stroke: { width: 0 } },
opacity: { value: 0.5, random: true, anim: { enable: true, speed: 1, opacity_min: 0.1 } },
size: { value: 3, random: true, anim: { enable: true, speed: 2, size_min: 0.1 } },
line_linked: { enable: true, distance: 150, color: '#ffaa33', opacity: 0.2, width: 1 },
move: { enable: true, speed: 1.5, direction: 'none', random: true, straight: false, out_mode: 'out' }
},
interactivity: {
detect_on: 'canvas',
events: { onhover: { enable: true, mode: 'grab' }, onclick: { enable: true, mode: 'push' } },
modes: { grab: { distance: 140, line_linked: { opacity: 0.5 } }, push: { particles_nb: 3 } }
},
retina_detect: true
});

// ========== NAVIGASI ==========
const generatorPage = document.getElementById('generatorPage');
const detailsPage = document.getElementById('detailsPage');
const detailBtn = document.getElementById('detailBtn');
const backBtn = document.getElementById('backBtn');
const isekaiBtn = document.getElementById('isekaiBtn');

detailBtn.addEventListener('click', () => {
const rect = detailBtn.getBoundingClientRect();
createSpellEffect(rect.left + rect.width/2, rect.top + rect.height/2, '#8bb4ff', 8);
generatorPage.classList.add('hidden');
detailsPage.classList.remove('hidden');
});

backBtn.addEventListener('click', () => {
const rect = backBtn.getBoundingClientRect();
createSpellEffect(rect.left + rect.width/2, rect.top + rect.height/2, '#e5b073', 8);
detailsPage.classList.add('hidden');
generatorPage.classList.remove('hidden');
});

isekaiBtn.addEventListener('click', async (e) => {
const rect = e.target.getBoundingClientRect();
const centerX = rect.left + rect.width/2;
const centerY = rect.top + rect.height/2;

// Simulasi proses verifikasi sidik jari
isekaiBtn.classList.add('scanning');
isekaiBtn.innerHTML = `
<div class="fingerprint-icon">
<i class="fas fa-spinner fa-pulse"></i>
<div class="ripple-circle"></div>
<div class="ripple-circle"></div>
<div class="ripple-circle"></div>
</div>
<span>Memindai Sidik Jari...</span>
`;

setTimeout(() => {
isekaiBtn.classList.remove('scanning');
isekaiBtn.classList.add('verified');
isekaiBtn.innerHTML = `
<div class="fingerprint-icon">
<i class="fas fa-check-circle"></i>
<div class="ripple-circle"></div>
<div class="ripple-circle"></div>
<div class="ripple-circle"></div>
</div>
<span>Verifikasi Berhasil!</span>
<i class="fas fa-arrow-right"></i>
`;

// Efek portal besar setelah verifikasi
triggerIsekaiPortal();

// Efek partikel spiral
for (let i = 0; i < 40; i++) {
setTimeout(() => {
const angle = (i / 40) * Math.PI * 2;
const radius = 120;
const x = centerX + Math.cos(angle) * radius;
const y = centerY + Math.sin(angle) * radius;
createSpellEffect(x, y, `hsl(${i * 9 + 300}, 100%, 60%)`, 2);
}, i * 25);
}

// Kembalikan tombol ke keadaan normal setelah efek
setTimeout(() => {
isekaiBtn.classList.remove('verified');
isekaiBtn.innerHTML = `
<div class="fingerprint-icon">
<i class="fas fa-fingerprint"></i>
<div class="ripple-circle"></div>
<div class="ripple-circle"></div>
<div class="ripple-circle"></div>
</div>
<span>Tempel Jempol untuk Isekai</span>
<i class="fas fa-arrow-right"></i>
`;
}, 2000);

}, 1000);

const area = document.getElementById('resultArea');
area.innerHTML = `<div class="loading"><i class="fas fa-spinner fa-pulse"></i> Sabar nyed ... lagi dibikinin jadi apa :v</div>`;

try {
const character = await generateCharacter();
renderCharacter(character);
} catch (e) {
console.error(e);
area.innerHTML = `<div class="loading">Yahh... gagal deh bikin karakternya.</div>`;
}
});

window.addEventListener('load', async () => {
const area = document.getElementById('resultArea');
area.innerHTML = `<div class="loading"><i class="fas fa-spinner fa-pulse"></i> Sabar nyed ... lagi dibikinin jadi apa :v</div>`;
try {
const initialChar = await generateCharacter();
renderCharacter(initialChar);
} catch (e) {
console.error(e);
area.innerHTML = `<div class="loading">Yahh... gagal deh bikin karakternya. Refresh?</div>`;
}
});

anime({
targets: '.floating-element',
translateX: function() { return anime.random(-40, 40); },
translateY: function() { return anime.random(-40, 40); },
scale: function() { return anime.random(0.8, 1.2); },
duration: 4000,
easing: 'easeInOutQuad',
loop: true,
direction: 'alternate'
});
})();
</script>
</body>
</html>
